<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.10.0 by Michael Rose
  Copyright 2013-2018 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE.txt
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Perplexity - Shuseiâ€™s Website</title>
<meta name="description" content="Perplexity is commonly used to evaluate language models.">



<meta property="og:type" content="article">
<meta property="og:locale" content="en">
<meta property="og:site_name" content="Shusei's Website">
<meta property="og:title" content="Perplexity">
<meta property="og:url" content="http://localhost:4000/natural%20language%20processing/perplexity/">


  <meta property="og:description" content="Perplexity is commonly used to evaluate language models.">







  <meta property="article:published_time" content="2017-06-17T00:00:00-04:00">





  

  


<link rel="canonical" href="http://localhost:4000/natural%20language%20processing/perplexity/">







  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "Person",
      "name": "Shusei Eshima",
      "url": "http://localhost:4000",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="Shusei's Website Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">

<!--[if lte IE 9]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="http://localhost:4000/">Shusei's Website</a>
        <ul class="visible-links">
          
            
            <li class="masthead__menu-item">
              <a href="http://localhost:4000/biocv/" >Bio/CV</a>
            </li>
          
            
            <li class="masthead__menu-item">
              <a href="http://localhost:4000/research/" >Research</a>
            </li>
          
            
            <li class="masthead__menu-item">
              <a href="http://localhost:4000/software/" >Software</a>
            </li>
          
            
            <li class="masthead__menu-item">
              <a href="http://localhost:4000/data/" >Data</a>
            </li>
          
            
            <li class="masthead__menu-item">
              <a href="http://localhost:4000/blog/" >Blog</a>
            </li>
          
        </ul>
        
        <button class="search__toggle" type="button">
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle Menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    <div class="initial-content">
      <script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_CHTML">
</script>





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="http://schema.org/Person">

  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Shusei Eshima</h3>
    
    
      <p class="author__bio" itemprop="description">
        PhD Student. I am interested in Political Methodology and Comparative Politics.
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="http://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Cambridge, MA</span>
        </li>
      

      
        <li>
          <a href="https://shusei-e.github.io" itemprop="url">
            <i class="fas fa-fw fa-link" aria-hidden="true"></i> Website
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      
        <li>
          <a href="https://github.com/Shusei-E" itemprop="sameAs">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="http://schema.org/CreativeWork">
    <meta itemprop="headline" content="Perplexity">
    <meta itemprop="description" content="Perplexity is commonly used to evaluate language models.">
    <meta itemprop="datePublished" content="June 17, 2017">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 class="page__title" itemprop="headline">Perplexity
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  less than 1 minute read
</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p>Perplexity is commonly used to evaluate language models.</p>

<h2 id="definition-and-calculation">Definition and Calculation</h2>

<p>First, we need to know</p>

<p><span style="font-size:1.0em; line-height:0%">
<script type="math/tex">% <![CDATA[
\begin{align}
&\quad {\rm probability}\ p = \frac{1}{\rm choices}, \\
&\Leftrightarrow {\rm choices}\ c = \frac{1}{p}.
\end{align} %]]></script>
</span></p>

<p>Perplexity is the geometric mean of choices. <script type="math/tex">N</script> is the number of data, <script type="math/tex">c</script> is the number of choices.</p>

<p><span style="font-size:1.0em; line-height:0%">
<script type="math/tex">% <![CDATA[
\begin{align}
\left( \prod_{i=1}^{N} c_i \right)^{\frac{1}{N}} &= \left( \prod_{i=1}^{N} \frac{1}{p_i} \right)^{\frac{1}{N}} \\[10pt]
&= \exp \left( \log \left( \prod_{i=1}^{N} \frac{1}{p_i} \right)^{\frac{1}{N}} \right) \\[10pt]
&= \exp \left( \dfrac{\sum_{i=1}^N -(\log p_i)}{N} \right) \\[10pt]
&= \exp \left( \frac{-{\rm loglik}}{N} \right)
\end{align} %]]></script>
</span></p>

<p>If perplexity becomes negative, you might need to take into account normalization constants. If you calculate the perplexity right after you initialize the model (randomly fill parameters), perplexity could be greater than the number of unique words in the corpus.</p>

<h2 id="explanation">Explanation</h2>
<p>Ideally, we want to know <script type="math/tex">p(w)</script>, but we need to consider the complete data log-likelihood <script type="math/tex">p(w,z)</script>. So, we take</p>

<p><span style="font-size:1.0em; line-height:0%">
<script type="math/tex">% <![CDATA[
\begin{align}
&\sum_z p(w,z) \approx \frac{1}{S} \sum_{s=1}^S p(w, z(s))
\end{align} %]]></script>
</span></p>

<p><script type="math/tex">S</script> is the number of simulation after enough number of iterations. <script type="math/tex">z(s)</script> is the value of latent variable under <script type="math/tex">s^{\rm th}</script> simulation. If we take the mean of perplexity, it could be an approximation of all possible <script type="math/tex">z</script>.</p>

<h2 id="test-perplexity">Test Perplexity</h2>
<p><script type="math/tex">\begin{align}
p(\mathbf{w}^{\rm Test} | \mathbf{w}^{\rm Train}) = \int p(\mathbf{w}^{\rm Test} | \theta) p(\theta | \mathbf{w}^{\rm Train}) d\theta
\end{align}</script></p>

<p>This is a weighted average by the trained parameters. In the following example, we consider three topics.</p>

<table>
  <thead>
    <tr>
      <th>Topics <script type="math/tex">p(z)</script></th>
      <th><script type="math/tex">p(w|z)</script></th>
      <th><script type="math/tex">p(w,z)</script></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><script type="math/tex">p(z=1)=0.5</script></td>
      <td><script type="math/tex">0.05</script></td>
      <td><script type="math/tex">0.025</script></td>
    </tr>
    <tr>
      <td><script type="math/tex">p(z=2)=0.2</script></td>
      <td><script type="math/tex">0.03</script></td>
      <td><script type="math/tex">0.006</script></td>
    </tr>
    <tr>
      <td><script type="math/tex">p(z=3)=0.1</script></td>
      <td><script type="math/tex">0.01</script></td>
      <td><script type="math/tex">0.001</script></td>
    </tr>
  </tbody>
</table>

<p>We sum up <script type="math/tex">p(w,z)</script>.</p>

        
      </section>

      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="http://localhost:4000/categories/#natural-language-processing" class="page__taxonomy-item" rel="tag">Natural Language Processing</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2017-06-17T00:00:00-04:00">June 17, 2017</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="http://localhost:4000/natural%20language%20processing/LDA-CGS-loglikelihood/" class="pagination--pager" title="Log Likelihood of LDA in CGS
">Previous</a>
    
    
      <a href="http://localhost:4000/bayesian%20analysis/BayesianMultipleRegression/" class="pagination--pager" title="Bayesian Multiple Regression
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><input type="text" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
    <div id="results" class="results"></div></div>
      </div>
    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
    
    
      <li><a href="https://github.com/Shusei-E"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    
    <li><a href="http://localhost:4000/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2019 Shusei Eshima. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="http://localhost:4000/assets/js/main.min.js"></script>
  <script src="https://use.fontawesome.com/releases/v5.0.7/js/all.js"></script>




<script src="http://localhost:4000/assets/js/lunr/lunr.min.js"></script>
<script src="http://localhost:4000/assets/js/lunr/lunr-store.js"></script>
<script src="http://localhost:4000/assets/js/lunr/lunr-en.js"></script>





  </body>
</html>